<!DOCTYPE html>
<html class="rd-template-admin">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>MOMOMAL Manage Products</title>
        <link rel="stylesheet" href="assets/css/sanitize/sanitize.css?npm-v=github%3Acsstools%2Fsanitize.css%23main">
        <link rel="stylesheet" href="assets/css/sanitize/typography.css?npm-v=github%3Acsstools%2Fsanitize.css%23main">
        <link rel="stylesheet" href="assets/css/sanitize/forms.css?npm-v=github%3Acsstools%2Fsanitize.css%23main">
        <link rel="stylesheet" href="assets/font-awesome/css/all.min.css?npm-v=6.0.0">
        <link rel="stylesheet" href="assets/css/smartmenus/sm-core-css.css?npm-v=1.1.1">
        <link rel="stylesheet" href="assets/css/smartmenus/sm-rdta/sm-rdta.css?v=49e159bb1b8cc5ae941d93c1508e901e">
        <link rel="stylesheet" href="assets/css/rdta/typo-and-form/typo-and-form.css?v=52a379fee397f2eb7dea26651210db79">
        <link rel="stylesheet" href="assets/css/rdta/rundiz-template-admin.css?v=917288fcd4d374406ac60af71a632444">
        <link class="exclude-preview" rel="stylesheet" href="assets/css-preview/prism.css?v=de20a76f891181fd461354e782db7a0f">
        <link class="exclude-preview" rel="stylesheet" href="assets/css-preview/documents.css?v=723a2316bd4d6e8a361b431002473a2c">
        <link class="exclude-preview" rel="stylesheet" href="assets/css-preview/view-source.css?v=882e2b16871a0ba615594d2595727886">
        <link rel="stylesheet" href="assets/css/rdta/columns/columns-flex.css?v=5a1243343c98bcb2a0956d100c7e15d7">
        <style>
            body {
                background-color: #ffffff;
                color: #1a1a1a;
                font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', sans-serif;
                line-height: 1.6;
            }

            .rd-navbar {
                background-color: #ffffff;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
                padding: 1rem;
            }

            .rd-site-brand a {
                color: #1a1a1a;
                font-size: 1.5rem;
                font-weight: 600;
                text-decoration: none;
            }

            .rd-sidebar {
                background-color: #f8fafc;
                border-right: 1px solid #e5e7eb;
            }

            .rd-sidebar-item-list a {
                color: #374151;
                transition: all 0.2s ease;
                border-radius: 6px;
                padding: 0.75rem 1rem;
                margin: 0.25rem 0.5rem;
            }

            .rd-sidebar-item-list a:hover {
                background-color: #e5e7eb;
                color: #1a1a1a;
            }

            .rd-sidebar-item-list a.active {
                background-color: #3b82f6;
                color: #ffffff;
                font-weight: 500;
            }

            .example-card {
                background-color: #ffffff;
                border: 1px solid #e5e7eb;
                border-radius: 8px;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
                padding: 1.5rem;
                margin-bottom: 1.5rem;
                transition: transform 0.2s ease;
            }

            .example-card:hover {
                transform: translateY(-2px);
            }

            .example-card h3 {
                color: #1a1a1a;
                font-size: 1.25rem;
                font-weight: 600;
                margin-bottom: 1rem;
            }

            .product-form {
                display: grid;
                gap: 1rem;
                margin-bottom: 2rem;
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            }

            .product-form input,
            .product-form select,
            .product-form textarea {
                padding: 0.75rem;
                border-radius: 6px;
                border: 1px solid #d1d5db;
                background-color: #ffffff;
                font-size: 0.875rem;
                color: #1a1a1a;
                transition: border-color 0.2s ease;
            }

            .product-form input:focus,
            .product-form select:focus,
            .product-form textarea:focus {
                outline: none;
                border-color: #3b82f6;
                box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
            }

            .product-form input[readonly] {
                background-color: #f3f4f6;
                cursor: not-allowed;
            }

            .product-form textarea {
                height: 100px;
                resize: vertical;
                grid-column: span 2;
            }

            .product-form .form-actions {
                grid-column: span 2;
                display: flex;
                gap: 0.5rem;
            }

            .product-form button,
            .edit-btn,
            .delete-btn,
            .preview-btn,
            .cancel-btn {
                padding: 0.75rem 1.5rem;
                border-radius: 6px;
                border: none;
                cursor: pointer;
                font-size: 0.875rem;
                font-weight: 500;
                transition: background-color 0.2s ease;
                display: inline-flex;
                align-items: center;
                justify-content: center;
            }

            .product-form button {
                background-color: #3b82f6;
                color: #ffffff;
            }

            .product-form button:hover {
                background-color: #2563eb;
            }

            .edit-btn {
                background-color: #10b981;
                color: #ffffff;
            }

            .edit-btn:hover {
                background-color: #059669;
            }

            .delete-btn {
                background-color: #ef4444;
                color: #ffffff;
            }

            .delete-btn:hover {
                background-color: #dc2626;
            }

            .preview-btn {
                background-color: #8b5cf6;
                color: #ffffff;
            }

            .preview-btn:hover {
                background-color: #7c3aed;
            }

            .cancel-btn {
                background-color: #6b7280;
                color: #ffffff;
            }

            .cancel-btn:hover {
                background-color: #4b5563;
            }

            .rd-datatable {
                width: 100%;
                border-collapse: collapse;
                background-color: #ffffff;
                border-radius: 8px;
                overflow: hidden;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            }

            .rd-datatable th,
            .rd-datatable td {
                padding: 1rem;
                text-align: left;
                border-bottom: 1px solid #e5e7eb;
                font-size: 0.875rem;
            }

            .rd-datatable th {
                background-color: #f8fafc;
                color: #1a1a1a;
                font-weight: 600;
            }

            .rd-datatable td {
                color: #4b5563;
            }

            .rd-breadcrumb {
                margin-bottom: 1.5rem;
            }

            .rd-breadcrumb li a {
                color: #3b82f6;
                text-decoration: none;
                font-size: 0.875rem;
            }

            .rd-breadcrumb li a:hover {
                text-decoration: underline;
            }

            .error {
                color: #dc2626;
                font-size: 0.875rem;
                margin-bottom: 1rem;
                display: none;
                grid-column: span 2;
            }

            hr {
                border-color: #e5e7eb;
                margin: 1rem 0;
            }

            @media (max-width: 768px) {
                .example-card {
                    padding: 1rem;
                }

                .rd-datatable th,
                .rd-datatable td {
                    padding: 0.75rem;
                }

                .product-form {
                    grid-template-columns: 1fr;
                }

                .product-form textarea,
                .product-form .form-actions,
                .error {
                    grid-column: span 1;
                }

                .product-form button,
                .edit-btn,
                .delete-btn,
                .preview-btn,
                .cancel-btn {
                    padding: 0.5rem 1rem;
                }
            }
        </style>
    </head>
    <body>

        <div class="rd-page-wrapper">
            <div class="rd-sidebar-back"></div>
            <section class="rd-sidebar">
                <h2 class="screen-reader-only">Sidebar menus</h2>
                <div class="rd-sidebar-inner">
                    <ul class="rd-sidebar-item-list sm sm-vertical sm-rdta">
                        <li><a href="admin.html" title="Admin home"><i class="sidebar-icon fa-solid fa-gauge-high fa-fw"></i> <span class="rd-sidebar-menu-text">Dashboard</span></a></li>
                        <li><a href="manage-users.html" title="Manage Users"><i class="sidebar-icon fa-solid fa-users fa-fw"></i> <span class="rd-sidebar-menu-text">Kelola Pengguna</span></a></li>
                        <li><a href="manage-articles.html" title="Manage Articles"><i class="sidebar-icon fa-solid fa-newspaper fa-fw"></i> <span class="rd-sidebar-menu-text">Kelola Artikel</span></a></li>
                        <li><a href="manage-products.html" title="Manage Products" class="active"><i class="sidebar-icon fa-solid fa-box fa-fw"></i> <span class="rd-sidebar-menu-text">Kelola Produk</span></a></li>
                        <li><a href="admin.html#transactions" title="Transactions"><i class="sidebar-icon fa-solid fa-receipt fa-fw"></i> <span class="rd-sidebar-menu-text">Transaksi</span></a></li>
                        <li class="divider"></li>
                    </ul>
                    <ul class="rd-sidebar-item-list rd-sidebar-expand-collapse-controls">
                        <li>
                            <a data-target=".rd-page-wrapper" title="Expand/collapse menu"><i class="sidebar-icon faicon fa-solid fa-chevron-left fa-fw" data-toggle-icon="fa-chevron-left fa-chevron-right"></i> <span class="screen-reader-only" aria-hidden="true">Expand/collapse menu</span></a>
                            <hr>
                        </li>
                    </ul>
                </div>
            </section>
            <main>
                <nav>
                    <ul class="rd-breadcrumb">
                        <li><a href="admin.html">Dashboard</a></li>
                        <li class="current"><a href="manage-products.html">Kelola Produk</a></li>
                    </ul>
                </nav>
                <div class="rd-page-content">
                    <div class="rd-columns-flex-container fix-columns-container-edge">
                        <div class="column">
                            <div class="example-card">
                                <h3>Kelola Produk</h3>
                                <div id="formError" class="error"></div>
                                <form id="productForm" class="product-form">
                                    <input type="hidden" id="productId">
                                    <input type="text" id="productName" placeholder="Nama Produk" required>
                                    <input type="number" id="productPrice" placeholder="Harga (Rp)" required min="0">
                                    <input type="text" id="productCode" placeholder="Kode Produk" readonly required>
                                    <input type="text" id="productImages" placeholder="URL Gambar (pisahkan dengan koma)">
                                    <input type="number" id="productStock" placeholder="Stok" required min="0">
                                    <input type="text" id="productBrand" placeholder="Merek" required>
                                    <select id="productCondition" required>
                                        <option value="" disabled selected>Pilih Kondisi</option>
                                        <option value="Baru">Baru</option>
                                        <option value="Bekas">Bekas</option>
                                    </select>
                                    <input type="number" id="productMinOrder" placeholder="Min. Pemesanan" required min="1">
                                    <input type="text" id="productCategory" placeholder="Kategori" required>
                                    <input type="text" id="productMaterial" placeholder="Bahan" required>
                                    <textarea id="productSpecifications" placeholder="Spesifikasi" required></textarea>
                                    <div class="form-actions">
                                        <button type="submit">Simpan Produk</button>
                                        <button type="button" id="cancelProduct" class="cancel-btn" style="display: none;">Batal</button>
                                    </div>
                                </form>
                                <table class="rd-datatable responsive">
                                    <thead>
                                        <tr>
                                            <th class="column-primary">Nama</th>
                                            <th>Harga</th>
                                            <th>Kode</th>
                                            <th>Stok</th>
                                            <th>Kategori</th>
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody id="productTableBody"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
            <footer></footer>
        </div>
        <script class="exclude-preview">
            const rdta_debug = false;
        </script>
        <script src="//code.jquery.com/jquery-3.4.1.min.js"></script>
        <script src="assets/js/smartmenus/jquery.smartmenus.min.js?npm-v=1.1.1"></script>
        <script src="assets/js/popper.js/umd/popper.min.js?npm-v=2.11.2"></script>
        <script src="assets/js/sticky-sidebar/jquery.sticky-sidebar.min.js?npm-v=3.3.1"></script>
        <script src="assets/js/resize-sensor/ResizeSensor.js?v=8652505c23e8fdc8016445c5e13bee64"></script>
        <script src="assets/js/rdta/rundiz-template-admin.js?v=94563169fb1da0c698556f60530a377a"></script>
        <script class="exclude-preview" src="assets/js-preview/prism.js?v=0718daece78cc150461b32c0ceab4fab" data-manual></script>
        <script class="exclude-preview" src="assets/js-preview/view-target-source.js?v=c9c8f5d72845b3693400fb9490283bfa"></script>
        <script class="exclude-preview" src="assets/js-preview/view-source.js?v=a7a9a35d448fd74928624a3f56b5bfdc"></script>
        <script class="exclude-preview" src="assets/js-preview/document-utils.js?v=73715f0a453f151dc904badc2234118e"></script>
        <script>
            // UUID generator
            function generateUUID() {
                return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);
                    return v.toString(16);
                });
            }

            // Generate product code based on the number of products
            function generateProductCode(products) {
                const count = products.length + 1;
                return `PRD-${String(count).padStart(3, '0')}`;
            }

            // Product Management
            function loadProducts() {
                const products = JSON.parse(localStorage.getItem('products') || '[]');
                const tableBody = document.getElementById('productTableBody');
                tableBody.innerHTML = '';

                products.forEach((product, index) => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="column-primary" data-colname="Nama">
                            ${product.name}
                            <button class="toggle-row" type="button"><i class="faicon fa-solid fa-caret-down fa-fw" data-toggle-icon="fa-caret-down fa-caret-up"></i><span class="screen-reader-only">Show more details</span></button>
                        </td>
                        <td data-colname="Harga">Rp${product.price.toLocaleString()}</td>
                        <td data-colname="Kode">${product.code}</td>
                        <td data-colname="Stok">${product.stock}</td>
                        <td data-colname="Kategori">${product.category}</td>
                        <td data-colname="Aksi">
                            <button class="edit-btn" onclick="editProduct(${index})">Edit</button>
                            <button class="delete-btn" onclick="deleteProduct(${index})">Hapus</button>
                            <button class="preview-btn" onclick="previewProduct('${product.id}')">Preview</button>
                        </td>
                    `;
                    tableBody.appendChild(row);
                });
            }

            function previewProduct(productId) {
                window.open(`product-detail.html?id=${productId}`, '_blank');
            }

            document.getElementById('productForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const errorDiv = document.getElementById('formError');
                errorDiv.style.display = 'none';
                errorDiv.textContent = '';

                const id = document.getElementById('productId').value || generateUUID();
                let code = document.getElementById('productCode').value;
                const products = JSON.parse(localStorage.getItem('products') || '[]');

                // Generate new product code for new products
                if (!document.getElementById('productId').value) {
                    code = generateProductCode(products);
                }

                // Check for unique product code
                if (products.some(p => p.code === code && p.id !== id)) {
                    errorDiv.textContent = 'Kode produk sudah digunakan. Silakan gunakan kode lain.';
                    errorDiv.style.display = 'block';
                    return;
                }

                const product = {
                    id,
                    name: document.getElementById('productName').value,
                    price: parseInt(document.getElementById('productPrice').value),
                    code,
                    images: document.getElementById('productImages').value.split(',').map(img => img.trim()).filter(img => img),
                    stock: parseInt(document.getElementById('productStock').value),
                    brand: document.getElementById('productBrand').value,
                    condition: document.getElementById('productCondition').value,
                    minOrder: parseInt(document.getElementById('productMinOrder').value),
                    category: document.getElementById('productCategory').value,
                    material: document.getElementById('productMaterial').value,
                    specifications: document.getElementById('productSpecifications').value
                };

                let productsArray = products;
                if (document.getElementById('productId').value) {
                    productsArray = productsArray.map(p => p.id === id ? product : p);
                    alert('Produk berhasil diperbarui!');
                } else {
                    productsArray.push(product);
                    alert('Produk berhasil ditambahkan!');
                }

                localStorage.setItem('products', JSON.stringify(productsArray));
                resetProductForm();
                loadProducts();
            });

            function editProduct(index) {
                const products = JSON.parse(localStorage.getItem('products') || '[]');
                const product = products[index];
                document.getElementById('productId').value = product.id;
                document.getElementById('productName').value = product.name;
                document.getElementById('productPrice').value = product.price;
                document.getElementById('productCode').value = product.code;
                document.getElementById('productImages').value = product.images.join(',');
                document.getElementById('productStock').value = product.stock;
                document.getElementById('productBrand').value = product.brand;
                document.getElementById('productCondition').value = product.condition;
                document.getElementById('productMinOrder').value = product.minOrder;
                document.getElementById('productCategory').value = product.category;
                document.getElementById('productMaterial').value = product.material;
                document.getElementById('productSpecifications').value = product.specifications;
                document.getElementById('cancelProduct').style.display = 'inline-block';
            }

            function deleteProduct(index) {
                if (confirm('Apakah Anda yakin ingin menghapus produk ini?')) {
                    let products = JSON.parse(localStorage.getItem('products') || '[]');
                    products.splice(index, 1);
                    localStorage.setItem('products', JSON.stringify(products));
                    loadProducts();
                    alert('Produk berhasil dihapus!');
                }
            }

            function resetProductForm() {
                document.getElementById('productForm').reset();
                document.getElementById('productId').value = '';
                const products = JSON.parse(localStorage.getItem('products') || '[]');
                document.getElementById('productCode').value = generateProductCode(products);
                document.getElementById('cancelProduct').style.display = 'none';
                document.getElementById('formError').style.display = 'none';
                document.getElementById('productCondition').value = '';
            }

            document.getElementById('cancelProduct').addEventListener('click', resetProductForm);

            window.onload = () => {
                const products = JSON.parse(localStorage.getItem('products') || '[]');
                document.getElementById('productCode').value = generateProductCode(products);
                loadProducts();
            };
        </script>
    </body>
</html>