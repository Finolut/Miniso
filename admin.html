<!DOCTYPE html>
<html class="rd-template-admin">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>MOMOMAL Admin Dashboard</title>
        <link rel="stylesheet" href="assets/css/sanitize/sanitize.css?npm-v=github%3Acsstools%2Fsanitize.css%23main">
        <link rel="stylesheet" href="assets/css/sanitize/typography.css?npm-v=github%3Acsstools%2Fsanitize.css%23main">
        <link rel="stylesheet" href="assets/css/sanitize/forms.css?npm-v=github%3Acsstools%2Fsanitize.css%23main">
        <link rel="stylesheet" href="assets/font-awesome/css/all.min.css?npm-v=6.0.0">
        <link rel="stylesheet" href="assets/css/smartmenus/sm-core-css.css?npm-v=1.1.1">
        <link rel="stylesheet" href="assets/css/smartmenus/sm-rdta/sm-rdta.css?v=49e159bb1b8cc5ae941d93c1508e901e">
        <link rel="stylesheet" href="assets/css/rdta/typo-and-form/typo-and-form.css?v=52a379fee397f2eb7dea26651210db79">
        <link rel="stylesheet" href="assets/css/rdta/rundiz-template-admin.css?v=917288fcd4d374406ac60af71a632444">
        <link class="exclude-preview" rel="stylesheet" href="assets/css-preview/prism.css?v=de20a76f891181fd461354e782db7a0f">
        <link class="exclude-preview" rel="stylesheet" href="assets/css-preview/documents.css?v=723a2316bd4d6e8a361b431002473a2c">
        <link class="exclude-preview" rel="stylesheet" href="assets/css-preview/view-source.css?v=882e2b16871a0ba615594d2595727886">
        <link rel="stylesheet" href="assets/css/rdta/columns/columns-flex.css?v=5a1243343c98bcb2a0956d100c7e15d7">
        <style>
            .example-card {
                border: 1px solid #ddd;
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
                margin-bottom: 1.250rem;
                padding: 0.625em;
            }
            .example-card.summary {
                background-color: #eee;
                color: #222;
            }
            .example-card.no-margin-bottom {
                margin-bottom: 0;
            }
            .status-select {
                padding: 5px;
                border-radius: 4px;
                border: 1px solid #ddd;
                width: 100%;
                margin-bottom: 10px;
            }
            .delete-btn {
                background: #e91e63;
                color: white;
                border: none;
                padding: 5px 10px;
                border-radius: 4px;
                cursor: pointer;
                transition: background 0.3s ease;
            }
            .delete-btn:hover {
                background: #c2185b;
            }
            .rd-datatable th, .rd-datatable td {
                padding: 8px;
                text-align: left;
            }
            .rd-sidebar-item-list a.active {
                background: #e91e63;
                color: white;
                border-radius: 4px;
            }
        </style>
    </head>
    <body>
        <header class="rd-navbar">
            <button class="rd-sidebar-toggler" data-target=".rd-page-wrapper" title="Toggle side bar menu"><i class="fa-solid fa-bars fa-fw"></i><span class="screen-reader-only" aria-hidden="true">Toggle side bar menu</span></button>
            <div class="rd-site-brand"><a href="./admin.html">Admin Dashboard</a></div>
            <nav class="nav-right">
                <ul class="sm sm-rdta navbar">
                    <li class="user"><a href="#"><i class="fa-regular fa-circle-user"></i></a>
                        <ul>
                            <li><a>Hello, Lutfino</a></li>
                            <li><a href="manage-users.html">Edit your account</a></li>
                            <li><a href="index.html">Logout</a></li>
                        </ul>
                    </li>
                </ul>
            </nav>
        </header>
        <div class="rd-page-wrapper">
            <div class="rd-sidebar-back"></div>
            <section class="rd-sidebar">
                <h2 class="screen-reader-only">Sidebar menus</h2>
                <div class="rd-sidebar-inner">
                    <ul class="rd-sidebar-item-list sm sm-vertical sm-rdta">
                        <li><a href="admin.html" title="Admin home" class="active"><i class="sidebar-icon fa-solid fa-gauge-high fa-fw"></i> <span class="rd-sidebar-menu-text">Dashboard</span></a></li>
                        <li><a href="manage-users.html" title="Manage Users"><i class="sidebar-icon fa-solid fa-users fa-fw"></i> <span class="rd-sidebar-menu-text">Kelola Pengguna</span></a></li>
                        <li><a href="manage-articles.html" title="Manage Articles"><i class="sidebar-icon fa-solid fa-newspaper fa-fw"></i> <span class="rd-sidebar-menu-text">Kelola Artikel</span></a></li>
                        <li><a href="manage-products.html" title="Manage Products"><i class="sidebar-icon fa-solid fa-box fa-fw"></i> <span class="rd-sidebar-menu-text">Kelola Produk</span></a></li>
                        <li><a href="admin.html#transactions" title="Transactions"><i class="sidebar-icon fa-solid fa-receipt fa-fw"></i> <span class="rd-sidebar-menu-text">Transaksi</span></a></li>
                        <li class="divider"></li>
                    </ul>
                    <ul class="rd-sidebar-item-list rd-sidebar-expand-collapse-controls">
                        <li>
                            <a data-target=".rd-page-wrapper" title="Expand/collapse menu"><i class="sidebar-icon faicon fa-solid fa-chevron-left fa-fw" data-toggle-icon="fa-chevron-left fa-chevron-right"></i> <span class="screen-reader-only" aria-hidden="true">Expand/collapse menu</span></a>
                            <hr>
                        </li>
                    </ul>
                </div>
            </section>
            <main>
                <nav>
                    <ul class="rd-breadcrumb">
                        <li class="current"><a href="admin.html">Dashboard</a></li>
                    </ul>
                </nav>
                <div class="rd-page-content">
                    <div class="rd-columns-flex-container fix-columns-container-edge">
                        <div class="column">
                            <div class="example-card">
                                <h1>Dashboard Momomall</h1>
                                <p>Jangan Lupa secangkir kopi di pagi hari</p>
                                <hr>
                            </div>
                        </div>
                        <div class="column-break"></div>
                        <div class="column col-lg-3 col-sm-6">
                            <div class="example-card summary">
                                <h3>Total Order</h3>
                                <p>Total <small class="rd-notification-badge tiny" id="totalOrders">0</small></p>
                            </div>
                        </div>
                        <div class="column col-lg-3 col-sm-6">
                            <div class="example-card summary">
                                <h3>Barang Sedang Diproses</h3>
                                <p>Processing <small class="rd-notification-badge tiny badge-info" id="processingCount">0</small></p>
                            </div>
                        </div>
                        <div class="column col-lg-3 col-sm-6">
                            <div class="example-card summary">
                                <h3>Barang Dikirim</h3>
                                <p>Shipped <small class="rd-notification-badge tiny badge-warning" id="shippedCount">0</small></p>
                            </div>
                        </div>
                        <div class="column col-lg-3 col-sm-6">
                            <div class="example-card summary">
                                <h3>Barang Selesai</h3>
                                <p>Delivered <small class="rd-notification-badge tiny badge-info" id="deliveredCount">0</small></p>
                            </div>
                        </div>
                        <div class="column-break"></div>
                        <div class="column">
                            <div class="example-card no-margin-bottom" id="transactions">
                                <h3>Transaction History</h3>
                                <table class="rd-datatable responsive">
                                    <thead>
                                        <tr>
                                            <th class="column-primary">Name</th>
                                            <th>Address</th>
                                            <th>Email</th>
                                            <th>Items</th>
                                            <th>Total</th>
                                            <th>Date</th>
                                            <th>Payment Method</th>
                                            <th>Status</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody id="transactionTableBody"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
            <footer></footer>
        </div>
        <script class="exclude-preview">
            const rdta_debug = false;
        </script>
        <script src="//code.jquery.com/jquery-3.4.1.min.js"></script>
        <script src="assets/js/smartmenus/jquery.smartmenus.min.js?npm-v=1.1.1"></script>
        <script src="assets/js/popper.js/umd/popper.min.js?npm-v=2.11.2"></script>
        <script src="assets/js/sticky-sidebar/jquery.sticky-sidebar.min.js?npm-v=3.3.1"></script>
        <script src="assets/js/resize-sensor/ResizeSensor.js?v=8652505c23e8fdc8016445c5e13bee64"></script>
        <script src="assets/js/rdta/rundiz-template-admin.js?v=94563169fb1da0c698556f60530a377a"></script>
        <script class="exclude-preview" src="assets/js-preview/prism.js?v=0718daece78cc150461b32c0ceab4fab" data-manual></script>
        <script class="exclude-preview" src="assets/js-preview/view-target-source.js?v=c9c8f5d72845b3693400fb9490283bfa"></script>
        <script class="exclude-preview" src="assets/js-preview/view-source.js?v=a7a9a35d448fd74928624a3f56b5bfdc"></script>
        <script class="exclude-preview" src="assets/js-preview/document-utils.js?v=73715f0a453f151dc904badc2234118e"></script>
        <script>
            // Transaction Management
            function loadTransactionHistory() {
                const transactions = JSON.parse(localStorage.getItem('transactions') || '[]');
                const tableBody = document.getElementById('transactionTableBody');
                tableBody.innerHTML = '';

                const totalOrders = transactions.length;
                const processingCount = transactions.filter(t => t.status === 'Processing').length;
                const shippedCount = transactions.filter(t => t.status === 'Shipped').length;
                const deliveredCount = transactions.filter(t => t.status === 'Delivered').length;

                document.getElementById('totalOrders').textContent = totalOrders;
                document.getElementById('processingCount').textContent = processingCount;
                document.getElementById('shippedCount').textContent = shippedCount;
                document.getElementById('deliveredCount').textContent = deliveredCount;

                transactions.forEach((transaction, index) => {
                    // Group items by name and count quantities
                    const itemCounts = {};
                    transaction.items.forEach(item => {
                        const key = item.name;
                        itemCounts[key] = (itemCounts[key] || 0) + (item.quantity || 1);
                    });

                    // Format items list
                    let itemsList = '';
                    const uniqueItems = Object.keys(itemCounts);
                    if (uniqueItems.length === 1) {
                        // If only one unique item, show full name
                        itemsList = `${uniqueItems[0]} (Rp${transaction.items[0].price.toLocaleString()})`;
                    } else {
                        // If multiple unique items, show name with quantity
                        itemsList = uniqueItems.map(itemName => `${itemName}(${itemCounts[itemName]})`).join(', ');
                    }

                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="column-primary" data-colname="Name">
                            ${transaction.customerName}
                            <button class="toggle-row" type="button"><i class="faicon fa-solid fa-caret-down fa-fw" data-toggle-icon="fa-caret-down fa-caret-up"></i><span class="screen-reader-only">Show more details</span></button>
                        </td>
                        <td data-colname="Address">${transaction.customerAddress}</td>
                        <td data-colname="Email">${transaction.customerEmail}</td>
                        <td data-colname="Items">${itemsList}</td>
                        <td data-colname="Total">Rp${transaction.total.toLocaleString()}</td>
                        <td data-colname="Date">${transaction.date}</td>
                        <td data-colname="Payment Method">${transaction.paymentMethod}</td>
                        <td data-colname="Status">
                            <select class="status-select" onchange="updateStatus(${index}, this.value)">
                                <option value="Processing" ${transaction.status === 'Processing' ? 'selected' : ''}>Processing</option>
                                <option value="Shipped" ${transaction.status === 'Shipped' ? 'selected' : ''}>Shipped</option>
                                <option value="Delivered" ${transaction.status === 'Delivered' ? 'selected' : ''}>Delivered</option>
                            </select>
                        </td>
                        <td data-colname="Action">
                            <button class="delete-btn" onclick="deleteTransaction(${index})">Hapus</button>
                        </td>
                    `;
                    tableBody.appendChild(row);
                });
            }

            function updateStatus(index, newStatus) {
                let transactions = JSON.parse(localStorage.getItem('transactions') || '[]');
                transactions[index].status = newStatus;
                localStorage.setItem('transactions', JSON.stringify(transactions));
                loadTransactionHistory();
            }

            function deleteTransaction(index) {
                if (confirm('Apakah Anda yakin ingin menghapus transaksi ini?')) {
                    let transactions = JSON.parse(localStorage.getItem('transactions') || '[]');
                    transactions.splice(index, 1);
                    localStorage.setItem('transactions', JSON.stringify(transactions));
                    loadTransactionHistory();
                }
            }

            window.onload = () => {
                loadTransactionHistory();
            };
        </script>
    </body>
</html>